\graphicspath{{content/chapters/7_evaluation/figures/}}
\chapter{Evaluation}
\label{chp:evaluation}

This chapter presents a comprehensive description of the testing and evaluation of the denoising models implemented during the project. Both classical DSP techniques and deep learning-based models are assessed using a range of objective metrics. The evaluation aims to compare the effectiveness of the various methods of implementation and options available throughout the project, all with the shared goal of maximising the quality of the denoised output. Therefore, the framework for the evaluation process is first established through detailed definitions of the metrics used to assess model performance.

\section{Evaluation Metrics}
\label{sec:evaluation_metrics_summary}

Previously in Chapter~\ref{chp:literature_review}, we provided brief introductions to the evaluation metrics used to assess model performance. Here, we explore each metric in greater detail, highlighting its relevance, strengths, and limitations.

\subsection{Signal-to-Noise Ratio (SNR)}

SNR is one of the most widely used metrics for assessing the quality of audio signals. It can only be calculated when both the signal to be tested and the corresponding clean signal are known. Mathematically, SNR is defined as the ratio of the power of the signal to the power of the noise:
\begin{equation}
\text{SNR} = 10 \cdot \log_{10} \left( \frac{\|s(t)\|^2}{\|s(t) - \hat{s}(t)\|^2} \right)
\end{equation}
where $s(t)$ is the clean signal and $\hat{s}(t)$ is the estimated (denoised) signal.

Higher SNR values indicate better audio quality, as the signal is more dominant than the noise. However, SNR can be misleading in certain situations. For instance, if a model outputs near-silent audio, the noise is also reduced, resulting in a deceptively high SNRâ€”even though the actual speech content may be unintelligible or missing. Therefore, while SNR is useful, it should never be used in isolation.

\subsection{Mean Squared Error (MSE)}

MSE is a commonly used error-based metric that quantifies the average squared difference between the predicted and target values. It is defined as:
\begin{equation}
\text{MSE} = \frac{1}{N} \sum_{i=1}^{N} (s_i - \hat{s}_i)^2
\end{equation}
where $s_i$ and $\hat{s}_i$ are the clean and predicted signal samples respectively.

Lower MSE values indicate better model performance, with a value of zero representing a perfect match. Like SNR, MSE also requires both the denoised and clean signals to be temporally aligned. MSE is especially sensitive to large deviations in prediction, but it does not account for perceptual quality, which limits its effectiveness as a standalone speech quality metric.

\subsection{Perceptual Evaluation of Speech Quality (PESQ)}

PESQ is a perceptual metric designed to approximate human auditory perception. It compares the clean and processed speech signals by simulating how humans perceive distortions, delay, and frequency masking. The PESQ score ranges from -0.5 to 4.5, where higher scores reflect better perceived quality.

This metric is widely used in telecommunications and is considered one of the most reliable for speech enhancement tasks. Unlike SNR and MSE, PESQ is not purely based on sample-level accuracy but rather on perceptual alignment. However, PESQ can be affected by signal length, speech characteristics, and type of background noise. For example, if a denoised output has unnatural robotic artefacts, PESQ may still assign it a high score despite its degraded perceptual quality.

\subsection{Short-Time Objective Intelligibility (STOI)}

STOI is a metric specifically designed to estimate the intelligibility of speech, which is a critical factor in speech enhancement. It quantifies how well a listener would understand the spoken content in the presence of noise. STOI scores range from 0 to 1, with values closer to 1 indicating higher intelligibility.

Unlike PESQ, which evaluates perceptual quality, STOI focuses solely on intelligibility. This makes it particularly useful in applications such as hearing aids or voice communication systems. STOI works by comparing the temporal envelopes of short-time segments of clean and noisy speech. Because of its robustness to mild distortions and focus on intelligibility, it is often used alongside PESQ for a complete evaluation.

\subsection{Log-Spectral Distance (LSD)}

LSD is a frequency-domain metric that measures the spectral distortion between the clean and denoised signals. It is computed as the root mean square of the log difference between the clean and estimated spectra across time and frequency:
\begin{equation}
\text{LSD} = \sqrt{\frac{1}{F} \sum_{f=1}^{F} \left(\log_{10} S(f) - \log_{10} \hat{S}(f) \right)^2}
\end{equation}

LSD is particularly important in evaluating how much the spectral shape of the signal has been preserved, which relates closely to the naturalness of the reconstructed audio. Since no official function for LSD exists in \texttt{torchmetrics} or \texttt{torchaudio}, a self-implemented version was developed based on widely accepted methodology \cite{enwiki_lsd}.

\subsection{Subjective Listening Tests}
\label{sec:subjective_listening_tests}

\section{Model Training Evaluation}